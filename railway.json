{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "RAILPACK"
  },
  "deploy": {
    "services": [
      {
        "name": "backend",
        "source": ".",
        "buildCommand": "pip install -r requirements.txt",
        "startCommand": "python -m uvicorn src.web.app:app --host 0.0.0.0 --port $PORT",
        "healthcheckPath": "/health",
        "healthcheckTimeout": 300,
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 10,
        "environmentVariables": {
          "PORT": "8000",
          "PYTHONPATH": "/app"
        }
      },
      {
        "name": "frontend",
        "source": "./frontend",
        "buildCommand": "npm install && npm run build",
        "startCommand": "npx serve -s dist -l $PORT",
        "healthcheckPath": "/",
        "healthcheckTimeout": 300,
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 10,
        "environmentVariables": {
          "PORT": "3000"
        }
      },
      {
        "name": "postgres",
        "source": "postgres",
        "type": "database"
      }
    ]
  }
}
